<!DOCTYPE html>
<html lang="en">

<head>
    <title>Leaflet</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <!-- Leaflet -->
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.4.0/leaflet.css" />
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.4.0/leaflet.js"></script>
    <!-- https://github.com/hnrchrdl/leaflet-tilelayer-colorizr -->
    <script src="leaflet-tilelayer-colorizer.js"></script>

    <style>
        html,
        body,
        #map {
            margin: 0;
            padding: 0;
            width: 100%;
            height: 100%;
            background-color: #000;
        }
    </style>

</head>

<body>
    <div id="map"></div>
    <script type="text/javascript">

        var mapCenter = new L.LatLng(0, 0);

        var lookupTable = [],
            colorTable = [[0,38,77],[26,51,89],[45,65,102],[62,79,114],[79,94,127],[96,110,140],[113,125,154],[130,142,167],[147,158,181],[165,175,195],[182,192,209],[202,211,224],[221,218,205],[232,223,160],[238,229,113],[241,234,47],[109,196,0],[105,195,0],[101,193,0],[97,192,0],[92,191,0],[88,189,0],[83,188,0],[78,187,0],[73,185,0],[67,184,0],[62,182,0],[55,181,0],[48,180,0],[41,178,0],[31,177,0],[19,175,0],[3,174,0],[24,176,4],[36,177,8],[46,178,12],[54,179,15],[61,181,18],[67,182,21],[73,183,23],[79,185,26],[84,186,28],[89,187,30],[94,189,33],[99,190,35],[104,191,37],[108,192,39],[113,194,41],[117,195,43],[122,196,44],[126,197,46],[130,199,48],[134,200,50],[139,201,52],[143,202,53],[147,204,55],[151,205,57],[155,206,59],[159,207,60],[163,208,62],[166,210,64],[170,211,65],[174,212,67],[178,213,69],[181,214,70],[179,212,68],[177,210,66],[175,208,64],[174,206,63],[172,205,61],[170,203,59],[168,201,58],[167,199,56],[165,198,54],[163,196,52],[161,194,50],[160,193,49],[158,191,47],[156,189,45],[154,187,43],[153,186,41],[151,184,39],[149,182,37],[148,180,35],[146,179,33],[144,177,31],[142,175,29],[141,174,27],[139,172,24],[137,170,22],[136,168,19],[134,167,16],[132,165,13],[130,163,9],[129,162,6],[127,160,2],[126,159,0],[125,158,0],[124,157,0],[123,156,0],[123,155,0],[122,154,0],[121,154,0],[120,153,0],[119,152,0],[119,151,0],[118,150,0],[117,149,0],[116,148,0],[115,148,0],[115,147,0],[114,146,0],[113,145,0],[112,144,0],[111,143,0],[111,142,0],[110,142,0],[109,141,0],[108,140,0],[108,139,0],[107,138,0],[106,137,0],[105,137,0],[104,136,0],[104,135,0],[103,134,0],[102,133,0],[101,132,0],[101,132,0],[100,131,0],[99,130,0],[98,129,0],[97,128,0],[97,128,0],[96,127,0],[95,126,0],[94,125,0],[93,124,0],[93,124,0],[92,123,0],[91,122,0],[90,121,0],[90,121,0],[89,120,0],[88,119,0],[87,118,0],[86,117,0],[86,117,0],[85,116,0],[84,115,0],[83,114,0],[82,113,0],[82,113,0],[81,112,0],[80,111,0],[79,110,0],[79,110,0],[78,109,0],[77,108,0],[76,107,0],[78,109,2],[82,112,5],[86,115,8],[91,118,12],[95,121,15],[99,124,19],[103,127,22],[107,130,24],[111,133,27],[115,136,30],[119,139,33],[123,142,35],[127,145,38],[131,148,41],[135,151,43],[139,154,46],[144,157,48],[148,160,51],[152,163,53],[156,166,56],[160,169,58],[165,173,61],[169,176,63],[173,179,66],[178,182,69],[182,185,71],[186,188,74],[190,191,76],[195,195,79],[199,198,81],[204,201,84],[208,204,86],[210,206,89],[211,207,92],[212,208,95],[213,209,98],[214,210,101],[215,211,104],[216,212,106],[217,213,109],[218,214,112],[219,215,115],[220,216,118],[221,217,120],[222,218,123],[223,219,126],[224,221,129],[225,222,131],[226,223,134],[227,224,137],[228,225,139],[229,226,142],[230,227,145],[231,228,148],[232,229,150],[233,230,153],[234,231,156],[235,232,158],[235,233,161],[236,235,164],[237,236,167],[238,237,169],[239,238,172],[240,239,175],[240,239,177],[240,239,179],[240,239,181],[240,239,183],[240,239,185],[241,239,187],[241,239,189],[241,239,191],[241,239,193],[241,239,195],[241,239,197],[241,239,199],[241,239,201],[241,239,203],[241,239,205],[241,239,208],[241,239,210],[241,240,212],[241,240,214],[241,240,216],[241,240,218],[241,240,220],[241,240,222],[241,240,224],[241,240,226],[241,240,228],[241,240,230],[240,240,232],[240,240,234],[240,240,236],[240,240,240]],
            i;

        for (i = 0; i < 11; i++) {
            lookupTable.push(-11000 + i * 1000);
        }
        lookupTable.push(-100);
        lookupTable.push( -50);
        lookupTable.push( -20);
        lookupTable.push( -10);
        lookupTable.push(  -1);
        for (i = 0; i < 150; i++) {
            lookupTable.push(20 * i);
        }
        for (i = 0; i < 60; i++) {
            lookupTable.push(3000 + 50 * i);
        }
        for (i = 0; i < 29; i++) {
            lookupTable.push(6000 + 100 * i);
        }

        function bisectRight (array, x) {
            for (var i = 0; i < array.length; i++) {
                if (array[i] > x) return i
            }
            return 0;
        }

        // https://github.com/tilezen/joerd/blob/master/docs/use-service.md
        //var baseLayer = new L.tileLayer.colorizr('https://s3.amazonaws.com/elevation-tiles-prod/terrarium/{z}/{x}/{y}.png', {
        var baseLayer = new L.tileLayer.colorizr('https://s3.amazonaws.com/elevation-tiles-prod/normal/{z}/{x}/{y}.png', {
            colorize: function(pixel) {
                // pixel is an object with red, green, blue and alpha channel like this {r, g, b, a}.
                var height,
                    value;

                height = (pixel.r * 256 + pixel.g + pixel.b / 256) - 32768;

                value = bisectRight(lookupTable, height);

                return {r: colorTable[value][0], g: colorTable[value][1], b: colorTable[value][2], a: 255};

            },
            maxZoom: 15
        });

        var overlayLayer = new L.tileLayer('http://donotbeonfire.co.uk:8080/data/hillshading/{z}/{x}/{y}.png', {
            maxZoom: 12,
            opacity: 0.6
        });

        var _map = new L.Map("map", {
            center: mapCenter,
            zoom: 2,
            layers: [baseLayer/* , overlayLayer */]
        });

    </script>
</body>

</html>
