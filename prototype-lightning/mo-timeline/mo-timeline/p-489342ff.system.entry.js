System.register(["./p-90717cf4.system.js","./p-b627769f.system.js","./p-9f1880d9.system.js","./p-2ccc9965.system.js"],(function(t){"use strict";var e,i,n,s,r,o,a,h;return{setters:[function(t){e=t.r;i=t.c;n=t.h;s=t.g},function(t){r=t.T;o=t.h},function(t){a=t.R},function(t){h=t.T}],execute:function(){if(window.NodeList&&!NodeList.prototype.forEach){NodeList.prototype.forEach=function(t,e){e=e||window;for(var i=0;i<this.length;i++){t.call(e,this[i],i,this)}}}var l=".slider{margin-top:1.6rem;width:100%;height:2.2rem;position:absolute;z-index:3;cursor:pointer}.slider__handle{width:6.4px;height:inherit;background-color:#B9DC0C;border-radius:20px;position:absolute;z-index:1000}.slider__handle:hover{cursor:e-resize;background-color:#89a308}.slider__timeBarSpacing{display:inline-block;height:1rem;position:absolute}#constraints{width:100%;height:2.2rem}.timeline-constraint{display:inline-block;height:2.2rem;width:6px;position:absolute}.timeline-constraint:hover,.timeline-constraint:active{cursor:col-resize}";var m=t("time_slider",function(){function t(t){e(this,t);this.dateClicked=i(this,"dateClicked",7);this.constraintChanged=i(this,"constraintChanged",7);this.timeLineConstraint={left:0,right:Number.MAX_SAFE_INTEGER};this.xOffset=0;this.timeBarPositions=[];this.resetTimeLine=false;this.resetTimeLineConstraints=false;this.setInitialSelectedTimeStep=true}t.prototype.constrainTimelineHandler=function(){this.resetTimeLineConstraints=true};t.prototype.watchHandler=function(){this.timeStepIndexUpdate()};t.prototype.timeStepsOnChangeHandler=function(t,e){this.timeStepSpacingService.setTimesteps(t);this.refreshTimeBarsPositions();if(e&&t.length!==e.length){this.resetTimeLineConstraints=true;this.resetTimeLine=true}};t.prototype.watchMouseState=function(t,e){if(!e.up&&t.up){this.mouseUp(t.xPos)}if(e.over&&!t.over){this.mouseUp(t.xPos)}if(e.xPos!==t.xPos){this.mouseMove(t.xPos)}if(!e.down&&t.down){this.mouseDown()}};t.prototype.componentWillLoad=function(){this.timeStepSpacingService=new h(this.timeSteps);this.timeStepUtils=new r};t.prototype.componentDidUpdate=function(){if(this.resetTimeLineConstraints){this.resetConstraints();this.resetTimeLineConstraints=false}if(this.resetTimeLine){this.refreshTimeBarsPositions();this.resetTimeLine=false}};t.prototype.render=function(){var t=this;if(this.timeSteps&&this.timeSteps.length>0){return n("div",{class:"slider"},n("div",{class:"slider__handle",ref:function(e){return t.handleElement=e}}),this.timeSteps.map((function(e,i){return n("div",{class:"slider__timeBarSpacing",style:t.timeStepProperties[i].style})})),this.constrainTimeline&&n("div",{id:"constraints"},n("div",{id:"constrainLeft",class:"timeline-constraint",ref:function(e){return t.constraintLeft=e}},n("svg",{xmlns:"http://www.w3.org/2000/svg",width:"6",height:"45",viewBox:"0 0 6 45"},n("polygon",{fill:"#007AA9",id:"constrain_left",points:"0 0 6 0 6 45 0 30"}))),n("div",{id:"constrainRight",class:"timeline-constraint",ref:function(e){return t.constraintRight=e}},n("svg",{xmlns:"http://www.w3.org/2000/svg",width:"6",height:"45",viewBox:"0 0 6 45"},n("polygon",{fill:"#007AA9",id:"constrain_right",points:"0 0 6 0 6 30 0 45"})))))}else{return n("div",null)}};t.prototype.componentDidLoad=function(){var t=this;this.refreshTimeBarsPositions();window.addEventListener("resize",(function(){t.refreshTimeBarsPositions()}));new a(this.el.firstElementChild,(function(){t.refreshTimeBarsPositions()}));this.resetConstraints()};t.prototype.componentDidRender=function(){if(this.setInitialSelectedTimeStep&&typeof this.timeStepIndex!=="undefined"&&typeof this.handleElement!=="undefined"){this.moveElement(this.handleElement,this.timeStepIndex,"- 3px");this.setInitialSelectedTimeStep=false}};t.prototype.refreshTimeBarsPositions=function(){var t=this;if(this.timeSteps&&this.timeSteps.length>0){this.timeBarPositions=[];var e=void 0;e=this.el.firstElementChild.querySelectorAll(".slider__timeBarSpacing");e.forEach((function(e,i){t.timeBarPositions.push({leftPos:e.getBoundingClientRect().left,rightPos:e.getBoundingClientRect().right,timeStepIndex:i})}))}};t.prototype.mouseUp=function(t){var e=this.findNearestTimeStepToPointer(t);if(this.constraintLeftActive){this.constraintLeftActive=false;this.moveLeftConstraint(e)}else if(this.constraintRightActive){this.constraintRightActive=false;this.moveRightConstraint(e)}else if(this.sliderHandleActive||(this.el===this.mouseState.target||this.el.contains(this.mouseState.target))){this.sliderHandleActive=false;e=this.findNearestActiveTimeStepToPointer(t);this.moveElement(this.handleElement,e,"- 3px");this.handleDateClick(e)}};t.prototype.mouseDown=function(){var t=window.document.getSelection();if(t.rangeCount>0&&t.getRangeAt(0).getClientRects().length>0){t.removeAllRanges()}if(this.mouseState.target===this.handleElement){this.sliderHandleActive=true}else if(this.constrainTimeline){if(this.mouseState.target===this.constraintRight||this.constraintRight.contains(this.mouseState.target)){this.constraintRightActive=true}else if(this.mouseState.target===this.constraintLeft||this.constraintLeft.contains(this.mouseState.target)){this.constraintLeftActive=true}}};t.prototype.mouseMove=function(t){if(this.sliderHandleActive){var e=this.findNearestActiveTimeStep(this.findNearestTimeStepToPointer(t));if(e!==this.timeStepIndex){this.handleDateClick(e)}this.moveElement(this.handleElement,e,"- 3px")}if(this.constraintLeftActive||this.constraintRightActive){var e=this.findNearestTimeStepToPointer(t);if(this.constraintRightActive){this.moveRightConstraint(e)}if(this.constraintLeftActive){this.moveLeftConstraint(e)}}};t.prototype.moveRightConstraint=function(t){if(t>this.timeLineConstraint.left){this.moveElement(this.constraintRight,t,"- 1px");this.timeLineConstraint={left:this.timeLineConstraint.left,right:t};this.constraintChanged.emit(this.timeLineConstraint)}};t.prototype.moveLeftConstraint=function(t){if(t<this.timeLineConstraint.right){this.moveElement(this.constraintLeft,t,"- 5px");this.timeLineConstraint={left:t,right:this.timeLineConstraint.right};this.constraintChanged.emit(this.timeLineConstraint)}};t.prototype.findNearestTimeStepToPointer=function(t){var e;if(t>this.timeBarPositions[this.timeBarPositions.length-1].rightPos){e=this.timeSteps.length-1}else if(t<this.timeBarPositions[0].leftPos){e=0}else{for(var i=0,n=this.timeBarPositions;i<n.length;i++){var s=n[i];if(s.leftPos<=t&&s.rightPos>=t){e=s.timeStepIndex}}}return e};t.prototype.findNearestActiveTimeStepToPointer=function(t){var e=this.findNearestTimeStepToPointer(t);e=this.findNearestActiveTimeStep(e);return e};t.prototype.findNearestActiveTimeStep=function(t){var e=this.disableTimesteps?this.loadedTimeStepMap:null;return this.timeStepUtils.findNearestActiveTimeStep(t,this.timeSteps.length,e,this.timeLineConstraint)};t.prototype.moveElement=function(t,e,i){if(typeof t!=="undefined"){this.xOffset=parseFloat(this.calculateSnapPosition(e));t.setAttribute("style","left: calc("+this.xOffset+"% "+i+") ")}};t.prototype.calculateSnapPosition=function(t){return this.timeStepSpacingService.calculateLHSPosPercentage(t)};t.prototype.timeStepIndexUpdate=function(){if(!this.sliderHandleActive){this.moveElement(this.handleElement,this.timeStepIndex,"- 3px")}};t.prototype.handleDateClick=function(t){this.dateClicked.emit(t)};t.prototype.resetConstraints=function(){if(typeof this.timeSteps!=="undefined"){this.timeLineConstraint.left=0;this.timeLineConstraint=this.timeStepUtils.resetTimelineConstraint(this.timeSteps.length);if(this.constrainTimeline){this.moveElement(this.constraintLeft,0,"- 5px");this.moveElement(this.constraintRight,this.timeSteps.length-1,"- 1px")}}};Object.defineProperty(t.prototype,"el",{get:function(){return s(this)},enumerable:false,configurable:true});Object.defineProperty(t,"watchers",{get:function(){return{constrainTimeline:["constrainTimelineHandler"],timeStepIndex:["watchHandler"],timeSteps:["timeStepsOnChangeHandler"],mouseState:["watchMouseState"]}},enumerable:false,configurable:true});return t}());m.style=l;var c=".timeBar{width:0;height:4rem;display:-ms-inline-flexbox;display:inline-flex;-ms-flex-direction:column;flex-direction:column;-ms-flex-align:center;align-items:center;z-index:2;position:absolute}.timeBar .timeBar__label{color:white;height:1rem;font-size:12px;margin-bottom:0.6rem;white-space:nowrap}.timeBar .timeBar__verticalLine{height:30%;margin-top:0.8rem;border-left:solid #C2C9CB thin;z-index:2}.timeBar .timeBar__verticalLineDisabled{height:30%;margin-top:0.8rem;border-left:solid #53676D thin;z-index:2}.timeBar .timeBar__largeVerticalLine{z-index:2;height:50%;border-left:solid white thin}.timeBar .timeBar__largeVerticalLineDisabled{z-index:2;height:50%;border-left:solid #53676D thin}";var d=t("time_step",function(){function t(t){e(this,t)}t.prototype.render=function(){if(this.timeData){var t="timeBar";if(!this.timeData.enabled){t+=" timeBar__disabledTimestep"}return n("div",{class:t,style:this.timeData.style},this.renderLabel(),this.renderVerticalLine())}else{return null}};t.prototype.renderLabel=function(){if(this.largeVerticalLineRequired()){return n("div",{class:"timeBar__label"},this.timeData.timeStep.format(this.labelFormat))}else{return n("div",{class:"timeBar__label"})}};t.prototype.renderVerticalLine=function(){var t="timeBar__";if(this.largeVerticalLineRequired()){t+="largeVerticalLine"}else{t+="verticalLine"}if(!this.timeData.enabled){t+="Disabled"}return n("div",{class:t})};t.prototype.largeVerticalLineRequired=function(){return this.timeDivisionChange()};t.prototype.timeDivisionChange=function(){var t=o(this.timeData.previousTimeStep).day();var e=o(this.timeData.timeStep).day();return!this.timeData.previousTimeStep||t!==e};return t}());d.style=c;var f;(function(t){t["RED"]="RED";t["AMBER"]="AMBER";t["YELLOW"]="YELLOW"})(f||(f={}));var p='.warningsContainer{width:100%;height:1.1rem;margin-top:2.5rem;position:absolute;z-index:1;left:0;display:grid;display:-ms-grid;-ms-grid-rows:1fr 1fr 1fr;overflow-x:hidden;grid-template-areas:"redWarning" "amberWarning" "yellowWarning"}.warningsContainer__redWarnings{grid-area:redWarning;-ms-grid-row:1;margin-bottom:0.075rem;position:absolute;width:100%}.warningsContainer__amberWarnings{grid-area:amberWarning;-ms-grid-row:2;margin-bottom:0.075rem;position:absolute;width:100%}.warningsContainer__yellowWarnings{-ms-grid-row:3;grid-area:yellowWarning;margin-bottom:0.075rem;position:absolute;width:100%}.warningsContainer__warning{height:4.5px;position:absolute;background-clip:content-box;margin-bottom:0.075rem}#severityRED{background-color:#CC0033}#severityAMBER{background-color:#FF9900}#severityYELLOW{background-color:#FFE923}';var u=t("timeline_warnings",function(){function t(t){e(this,t);this.warnings=[]}t.prototype.render=function(){return n("div",{class:"warningsContainer"},n("div",{class:"warningsContainer__redWarnings"},this.renderWarnings(f.RED)),n("div",{class:"warningsContainer__amberWarnings"},this.renderWarnings(f.AMBER)),n("div",{class:"warningsContainer__yellowWarnings"},this.renderWarnings(f.YELLOW)))};t.prototype.renderWarnings=function(t){var e=this;return this.warnings.map((function(i){if(o(i.validFrom).isBefore(o(e.lastTimeStep))){if(i.severity===t){return n("div",{class:"warningsContainer__warning",id:"severity"+t.toString(),style:e.calculateWarningPosition(i)})}}}))};t.prototype.calculateWarningPosition=function(t){return{width:this.calculateTimeDifferenceAsPercentage(o(t.validTo),o(t.validFrom))+"%",left:this.calculateTimeDifferenceAsPercentage(o(t.validFrom),o(this.firstTimeStep))+"%"}};t.prototype.calculateTimeDifferenceAsPercentage=function(t,e){var i=e.isBefore(o(this.firstTimeStep))?o(this.firstTimeStep):e;var n=t.isBefore(o(this.firstTimeStep))?o(this.firstTimeStep):t;var s=o.duration(o(n).diff(i)).asSeconds();var r=o.duration(o(this.lastTimeStep).diff(o(this.firstTimeStep))).asSeconds();return(Math.floor(s/r*100*100)/100).toFixed(2)};return t}());u.style=p}}}));